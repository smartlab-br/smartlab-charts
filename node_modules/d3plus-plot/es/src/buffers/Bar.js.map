{"version":3,"file":"Bar.js","sources":["../../../src/buffers/Bar.js"],"sourcesContent":["import {max, min, sum} from \"d3-array\";\nimport {nest} from \"d3-collection\";\n\nimport {default as ordinalBuffer} from \"./ordinalBuffer\";\n\n/**\n    Adds a buffer to either side of the non-discrete axis.\n    @param {Array} data\n    @param {D3Scale} x\n    @param {D3Scale} y\n    @param {Object} [config]\n    @param {Number} [buffer = 10]\n    @private\n*/\nexport default function({data, x, y, x2, y2, buffer = 10}) {\n  const xKey = x2 ? \"x2\" : \"x\";\n  const yKey = y2 ? \"y2\" : \"y\";\n\n  const oppScale = this._discrete === \"x\" ? y : x;\n\n  const oppDomain = oppScale.domain().slice();\n\n  const isDiscreteX = this._discrete === \"x\";\n\n  if (isDiscreteX) oppDomain.reverse();\n\n  let negVals, posVals;\n  if (this._stacked) {\n    const groupedData = nest()\n      .key(d => d[this._discrete])\n      .entries(data)\n      .map(d => d.values.map(x => x[isDiscreteX ? yKey : xKey]));\n    posVals = groupedData.map(arr => sum(arr.filter(d => d > 0)));\n    negVals = groupedData.map(arr => sum(arr.filter(d => d < 0)));\n  }\n  else {\n    posVals = data.map(d => d[isDiscreteX ? yKey : xKey]);\n    negVals = posVals;\n  }\n\n  let bMax = oppScale(max(posVals));\n  if (isDiscreteX ? bMax < oppScale(0) : bMax > oppScale(0)) bMax += isDiscreteX ? -buffer : buffer;\n  bMax = oppScale.invert(bMax);\n\n  let bMin = oppScale(min(negVals));\n  if (isDiscreteX ? bMin > oppScale(0) : bMin < oppScale(0)) bMin += isDiscreteX ? buffer : -buffer;\n  bMin = oppScale.invert(bMin);\n\n  if (bMax > oppDomain[1]) oppDomain[1] = bMax;\n  if (bMin < oppDomain[0]) oppDomain[0] = bMin;\n\n  if (isDiscreteX) oppDomain.reverse();\n\n  oppScale.domain(oppDomain);\n\n  const discreteScale = isDiscreteX ? x : y;\n  discreteScale.domain(ordinalBuffer(discreteScale.domain()));\n\n  return [x, y];\n\n}\n"],"names":["const","let","this"],"mappings":"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"}